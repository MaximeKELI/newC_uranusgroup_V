{% extends 'dashboard/admin_base.html' %}

{% block admin_content %}
<div class="mb-8" data-aos="fade-up">
    <div class="flex items-center justify-between">
        <div>
            <h1 class="text-4xl font-bold text-primary-dark mb-2">Mes Notifications</h1>
            <p class="text-gray-600">Toutes vos notifications</p>
        </div>
        <form method="post" action="{% url 'dashboard:mark_all_notifications_read' %}" class="inline">
            {% csrf_token %}
            <button type="submit" class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition">
                <i class="fas fa-check-double mr-2"></i> Tout marquer comme lu
            </button>
        </form>
    </div>
</div>

<div class="space-y-4">
    {% for notification in notifications %}
    <div class="admin-card p-6 {% if not notification.read %}border-l-4 border-primary-cyan{% endif %}" data-aos="fade-up" data-aos-delay="{{ forloop.counter0|mul:50 }}">
        <div class="flex items-start justify-between">
            <div class="flex-1">
                <div class="flex items-center mb-2">
                    <span class="badge {% if notification.type == 'error' %}badge-danger{% elif notification.type == 'warning' %}badge-warning{% elif notification.type == 'success' %}badge-success{% else %}badge-info{% endif %} mr-3">
                        {{ notification.get_type_display }}
                    </span>
                    {% if not notification.read %}
                    <span class="badge badge-warning">Non lu</span>
                    {% endif %}
                </div>
                <h3 class="text-lg font-bold text-primary-dark mb-2">{{ notification.title }}</h3>
                <p class="text-gray-700 mb-3">{{ notification.message }}</p>
                <p class="text-xs text-gray-500">{{ notification.created_at|date:"d/m/Y Ã  H:i" }}</p>
            </div>
            {% if not notification.read %}
            <form method="post" action="{% url 'dashboard:mark_notification_read' notification.id %}" class="ml-4">
                {% csrf_token %}
                <button type="submit" class="text-primary-cyan hover:text-primary-dark transition" title="Marquer comme lu">
                    <i class="fas fa-check"></i>
                </button>
            </form>
            {% endif %}
        </div>
    </div>
    {% empty %}
    <div class="admin-card p-12 text-center" data-aos="fade-up">
        <i class="fas fa-bell-slash text-6xl text-gray-400 mb-4"></i>
        <p class="text-xl text-gray-600">Aucune notification.</p>
    </div>
    {% endfor %}
</div>
{% endblock %}

